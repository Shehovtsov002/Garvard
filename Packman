#include <stdio.h>
#include <ctype.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>

// Как он работает?
// Ходит(wasd) напр: wddsa - пойти вверх, 2 раза вправо, вниз, влево
// Как работает карта? # - стены, @ - пакман, + - сборный предмет, 0 - привидение

typedef struct{
    int hp;
    int damage;
    int x;
    int y;
    char ap;
} Unit;

void takeDamage(Unit *agr, Unit *def){
    def->hp = def->hp - agr->damage;
    if(def->hp <= 0){
        printf("Вы проиграли!");
    }
}

const int X = 10;
const int Y = 10;
// Пакман
Unit pac;
// Набранные очки
int score = 0;

int map[10][10] = {
    {'#','#','#','#','#','#','#','#','#','#'},
    {'#',' ',' ','#',' ','#',' ','#','+','#'},
    {'#',' ','+','#','+',' ','+','#','+','#'},
    {'#',' ',' ',' ',' ','#',' ',' ',' ','#'},
    {'#','#','#','#','+','#','#','#','#','#'},
    {'#',' ',' ','+',' ',' ',' ',' ',' ','#'},
    {'#','+','#','#','#','+',' ','+',' ','#'},
    {'#',' ',' ',' ','#',' ',' ',' ',' ','#'},
    {'#',' ',' ',' ','#',' ',' ',' ',' ','#'},
    {'#','#','#','#','#','#','#','#','#','#'}
};

void createUnit(Unit *unit, int hp, int damage, int x, int y, char ap){
    unit->hp = hp;
    unit->damage = damage;
    unit->x = x;
    unit->y = y;
    unit->ap = ap;
    map[x][y] = ap;
}

void printMap(){
    printf("Score = %d\n", score);

    for(int i = 0; i < X; i++){
        for(int j = 0; j < Y; j++){
            printf("%c", map[i][j]);
        }
            printf("\n");
    }
            printf("\n");
}

void addScore(){
    if(map[pac.x][pac.y]=='+'){
        score = score + 1;
    }
}

void _moveTo(int _x, int _y){
    // Старые координаты меняем на пустоту
    map[pac.x][pac.y] = ' ';
    // Задаем новые координаты
    pac.x = _x;
    pac.y = _y;
    // Проверяем добавить ли очки
    addScore();
    // Проверяем не столкнулись ли мы с противником
    // Двигаем пакмана
    map[pac.x][pac.y] = '@';
    // Перерисовываем карту
    printMap();
}

void moveTo(char dir){
    switch(dir){
        case 'w':
            if(pac.x-1 < 0) break;
            if(map[pac.x-1][pac.y] == '#') break;
            _moveTo(pac.x-1, pac.y);
        break;

        case 'a':
            if(pac.y-1 < 0) break;
            if(map[pac.x][pac.y-1] == '#') break;
            _moveTo(pac.x, pac.y-1);
        break;

        case 's':
            if(pac.x+1 > X-1) break;
            if(map[pac.x+1][pac.y] == '#') break;
            _moveTo(pac.x+1, pac.y);
        break;

        case 'd':
            if(pac.y+1 > Y+1) break;
            if(map[pac.x][pac.y+1] == '#') break;
            _moveTo(pac.x, pac.y+1);
        break;
    }
}

int main(){
    createUnit(&pac, 100, 25, 5, 7, '@');

    Unit ghost;
    createUnit(&ghost, 50, 50, 7, 3, '0');

    printMap();
    char dir;

    do{
        scanf("%c", &dir);
        moveTo(dir);
    }while(dir != 'q');

    return 0;
}
